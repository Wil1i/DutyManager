<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="300">
    <title>پنل مدیریتی - اپل سرویس</title>
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="stylesheet" href="/css/fonts.css">
</head>
<body>
    
    <% for(const key in flash){ %>               
        <span role="alert" class="flash">
          <%= flash[key] %>
        </span>
    <% } %>

    <a href="/admin/new" id="addUser">+</a>

    <div id="container">
        <div id="containerBox">
            <li class="userContainer mainContainer">
                <p class="imageHandler"></p>

                <input placeholder="نام و نام خانوادگی" id="searchBox">

                <p>کد پرسنلی</p>

                <p>مقام</p>

                <p id="dutyHoursFilter">ساعت کاری</p>
                
                <p>تاریخ تولد</p>
            </li>

            <ul id="usersHandlerUL">
                

                <% users.forEach((u) => { %>
                    <li class="userContainer hover onFilter" id="<%=u.codePersoneli%>">
                        <p class="imageHandler">
                            <img 
                            <% if(duties.find(d => d.codePersoneli == u.codePersoneli)){ %>
                            title="حضور از ساعت <%= duties.find(d => d.codePersoneli == u.codePersoneli).startTime %>" 
                            <% } %>
                            src="/uploads/<%= (u.profile && u.profile != "") ? u.profile : "profile.png" %>" class="imageProfile <%= dutyList.includes(u.codePersoneli) ? "online" : "offline" %>">
                        </p>

                        <p class="userName"><%= u.firstName %> <%= u.lastName %></p>

                        <p><%= u.codePersoneli %></p>

                        <p><%= (u.userRank) ? u.userRank : "تایین نشده" %></p>

                        <p><%= (u.dutyHours < 10) ? `0${u.dutyHours}` : u.dutyHours %></p>
                        
                        <p><%= u.birthday %></p>
                    </li>
                <% }) %>
                
            </ul>
        </div>
    </div>

    <script src="/js/adminPageScripts.js" defer></script>
</body>
</html>